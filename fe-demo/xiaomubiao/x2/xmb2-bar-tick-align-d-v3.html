<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
    <title>åŠ æ²¹ğŸ†™ æ¯å¤©è¿›æ­¥ä¸€ç‚¹ç‚¹</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl/dist/echarts-gl.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat/dist/ecStat.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/map/js/china.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/map/js/world.js"></script>
    <!--<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=xfhhaTThl11qYVrqLZii6w8qE5ggnhrY&__ec_v__=20190126"></script>-->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/bmap.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <script src="../../config/config.js"></script>
</head>
<!-- ç®€å•æŸ±çŠ¶å›¾ ğŸ“Š åŠ¨æ€æ•°æ®
ç”¨åŸç”Ÿæ–¹æ³•æ·»åŠ å­¦ä¹ æ€»æ—¶é—´ï¼Œå¹³å‡æ—¶é—´
-->
<body style="height: 100%; width: 100%;">

<div id="container" style="height: 94%"></div>
<div id="sumTime" style="height: 6%"></div>

</body>

<!-- js -->
<script type="text/javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var app = {};
    option = null;
    var sumTime = 1;

    function setOpt(xData, yData) {
        if (!xData) {
            xData = ['2.22', '2.26']
        }
        if (!yData) {
            yData = [6, 8]
        }
        option = {
            title: {
                text: 'å°ç›®æ ‡-2 ç¾å¥³è‰³æ°å­¦ä¹ è®¡åˆ’',
                subtext: 'yè½´å½“æ—¥å­¦ä¹ æ—¶é—´(h)'
            },
            color: ['#3398DB'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {            // åæ ‡è½´æŒ‡ç¤ºå™¨ï¼Œåæ ‡è½´è§¦å‘æœ‰æ•ˆ
                    type: 'shadow'        // é»˜è®¤ä¸ºç›´çº¿ï¼Œå¯é€‰ä¸ºï¼š'line' | 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    //ç¬¬12å‘¨ 3.16å‘¨ä¸€ - 3.22å‘¨æ—¥
                    data: xData,
                    axisTick: {
                        alignWithLabel: true
                    }
                }
            ],
            yAxis: [
                {
                    type: 'value'
                }
            ],
            series: [
                {
                    name: 'å­¦ä¹ æ—¶é•¿(h)',
                    type: 'bar',
                    barWidth: '40%',
                    data: yData
                }
            ]
        };
        ;
        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
        for (let i = 0; i < yData.length; i++) {
            sumTime = sumTime + yData[i]
        }
        var html = 'å­¦ä¹ æ€»æ—¶é•¿: ' + sumTime + 'hï¼› <br>'
        html = html + 'å¹³å‡æ¯å¤©å­¦ä¹ æ—¶é•¿' + (sumTime / yData.length) + 'ï¼›'
        document.getElementById('sumTime').innerHTML = html;
    }


    function listMatterLog() {
        let xData = []
        let reachAmounts = []
        sumTime = sumTime + 1
        $.ajax({
            url: listMatterLogUrl,
            // url: 'http://localhost:63342/matter_log/list',
            async: true,
            type: 'get',
            dataType: 'json',
            success: function (resp) {
                // sleep(2000)
                // vm.$set('peoples', data.result);
                console.log('ajax matter_log/list ', resp)
                // ajaxData = resp
                let data = resp.data;
                for (let i = 0; i < data.length; i++) {
                    //[data[i].happenDate, data[i].reachAmount]
                    xData.push(data[i].happenDate)
                    reachAmounts.push(data[i].reachAmount)
                    // sumTime = sumTime + data[i].reachAmount
                }
                console.log('xData', xData, 'reachAmounts', reachAmounts)
                // myChart.hideLoading();    //éšè—åŠ è½½åŠ¨ç”»
                setOpt(xData, reachAmounts)
                console.log('jie shu')
                // $.getElementById('sumTime').innerHTML('å­¦ä¹ æ€»æ—¶é•¿: ' + sumTime + 'h')
                // document.getElementById('sumTime').innerText = 'å­¦ä¹ æ€»æ—¶é•¿: ' + sumTime + 'h';
            },
            error: function (xhr, errorType, error) {
                alert('Ajax request error, errorType: ' + errorType + ', error: ' + error);
            }
        });
    }


    $.ready
    {
        setOpt();
        listMatterLog();
    }

</script>
</html>
